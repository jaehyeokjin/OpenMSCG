import pytest
from mscg.cli import cgib

def test_2s(datafile):
    
    dfs = cgib.main(
        top     = datafile("methanol_1728_2s.data"),
        traj    = datafile("methanol_1728_2s.trr,frames=500"),
        names   = 'CH3,OH',
        cut     = 10.0,
        pair    = ['CH3,CH3,min=2.8,max=10.0,bins=200', 'CH3,OH,min=2.8,max=10.0,bins=200', 'OH,OH,min=2.5,max=10.0,bins=200'],
        bond    = ['CH3,OH,min=1.35,max=1.65,bins=60'],
        verbose = 0,
        save    = 'return'
    )
        
    print("")
    
    benchmarks = [
        [-5.5298435957485355,-5.535760036707398,-5.548019841135456,-5.555657042003876,-5.557045270210201,-5.556880829538393,-5.554390270737992,-5.545895000870049,-5.543391229428248,-5.539950086318647],
        [-5.779312359354629,-5.751901473028512,-5.728162698999857,-5.70200750605204,-5.680392091664878,-5.654602600520578,-5.630726996562123,-5.610644258153688,-5.594548349759463,-5.579187352636673],
        [-4.53462917895143,-4.55640918643041,-4.568139239825775,-4.599009613728689,-4.618693296030558,-4.651595038366765,-4.6710135679710145,-4.695892956931425,-4.7300021313219425,-4.756703561649041],
        [0.0004611756478643166,0.02032465184647329,0.060042837921425854,0.1086517347088433,0.1829625760767878,0.2621472150293949,0.35998081904329904,0.47472411143310084,0.6072952763891426,0.7321767523234428]
    ]
    
    for i in range(4):
        d = dfs[i]['data'][30:40,2]
        #print(','.join([str(_) for _ in d[:10]]))
        
        for j in range(10):
            assert abs(d[j]-benchmarks[i][j])<0.001